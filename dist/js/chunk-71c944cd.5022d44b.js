(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-71c944cd"],{"13d5":function(t,e,a){"use strict";var s=a("23e7"),i=a("d58f").left,n=a("a640"),l=a("ae40"),r=a("2d00"),c=a("605d"),o=n("reduce"),u=l("reduce",{1:0}),v=!c&&r>79&&r<83;s({target:"Array",proto:!0,forced:!o||!u||v},{reduce:function(t){return i(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"27fe":function(t,e,a){"use strict";a("b24e")},"2b88":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("main",{staticClass:"container"},[t.sliderWarpContract?t._e():a("div",{staticClass:"fixed-warp"},[a("div",{staticClass:"slider-warp"},[a("div",{staticClass:"titleForm flex-row-space-between"},[a("el-select",{staticStyle:{width:"90px"},attrs:{size:"mini"},model:{value:t.searchObj.order,callback:function(e){t.$set(t.searchObj,"order",e)},expression:"searchObj.order"}},t._l(t.orderOptions,(function(t){return a("el-option",{key:t.value,attrs:{value:t.value,label:t.label}})})),1),a("el-input",{staticStyle:{width:"106px"},attrs:{size:"mini"},model:{value:t.searchObj.url,callback:function(e){t.$set(t.searchObj,"url",e)},expression:"searchObj.url"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"suffix"},on:{click:t.newSelectData},slot:"suffix"})])],1),a("div",{staticClass:"page-line flex-column-center"},[a("div",{staticClass:"flex-row-space-between"},[a("div",{staticClass:"flex-column-center"},[a("el-pagination",{attrs:{small:"",layout:"prev, next",total:t.total,"current-page":t.page,"page-size":20},on:{"current-change":t.currentChange}})],1),a("div",{staticClass:"flex-column-center"},[a("span",{staticStyle:{color:"#969ba4","line-height":"25px"}},[a("strong",{staticStyle:{color:"#38435a","font-weight":"400"}},[t._v(t._s(t.page))]),t._v("/"+t._s(Math.ceil(t.total/20))+" ")])]),a("div",{staticClass:"flex-column-center"},[a("el-button",{staticStyle:{color:"#5782db"},attrs:{type:"text"},on:{click:t.getTableData}},[t._v(" 刷新 ")])],1)])]),t._l(t.tableData,(function(e){return a("div",{key:e.id,staticClass:"card",class:e.id===t.selectedId?t.cardRowClassName(!0,e.index):t.cardRowClassName(!1,e.index),attrs:{"track-by":"$index"},on:{click:function(a){return t.idChange(e.id)}}},[a("div",{staticClass:"titleLine"},[t._v(" "+t._s(e.uri+"存在"+e.type+"漏洞")+" ")]),a("div",{staticClass:"infoLine flex-row-space-between"},[a("span",{style:1===e.level_type?{color:"#EA7171"}:2===e.level_type?{color:"#F39D0A"}:3===e.level_type?{color:"#2E8FE9"}:4===e.level_type?{color:"#7BC1AB"}:""},[a("i",{staticClass:"iconfont iconweixian",staticStyle:{"font-size":"14px"}}),t._v(" "+t._s(e.level)+" ")]),a("span",[a("i",{staticClass:"iconfont iconshijian-2",staticStyle:{"font-size":"14px"}}),t._v(" "+t._s(e.latest_time)+" ")])])])}))],2)]),a("div",{staticClass:"operateCol",style:t.sliderWarpContract?{}:{"margin-left":"228px"}},[a("div",{staticStyle:{height:"100%"}},[a("i",{staticClass:"iconfont operateIcon",class:t.sliderWarpContract?"iconopen1-2":"iconopen11",on:{click:function(e){t.sliderWarpContract=!t.sliderWarpContract}}})])]),t.vulnObj.vul.url?a("div",{staticClass:"vuln-warp",class:t.sliderWarpContract?"slider-warp-contract":"slider-warp-spreadOut"},[a("div",{staticClass:"vuln-title flex-row-space-between"},[a("div",[t._v(" "+t._s(t.vulnObj.vul.url+"的"+t.vulnObj.vul.http_method+"请求出现"+t.vulnObj.vul.type+"漏洞"+(t.vulnObj.vul.taint_position?"，位置："+t.vulnObj.vul.taint_position:""))+" ")]),a("div",{staticClass:"btnWarp"},[a("el-button",{staticClass:"btn",attrs:{type:"text"},on:{click:t.exportVul}},[a("i",{staticClass:"iconfont icondaochu-5"}),t._v(" "+t._s(t.$t("views.vulnDetail.export"))+" ")]),a("el-button",{staticClass:"btn",attrs:{type:"text"},on:{click:function(e){t.deleteDialogOpen=!0}}},[a("i",{staticClass:"iconfont iconshanchu-6"}),t._v(" "+t._s(t.$t("views.vulnDetail.delete"))+" ")])],1)]),a("div",{staticClass:"module-title"},[t._v(" "+t._s(t.$t("views.vulnDetail.baseInfo"))+" ")]),a("div",{staticClass:"infoWarp"},[a("div",{staticClass:"infoLine flex-row-space-between"},[a("div",{staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconfuwuqi-3"}),t._v(" "+t._s(t.$t("views.vulnDetail.serverIp"))+": ")]),t._v(" "+t._s(t.vulnObj.server.ip)+" ")]),a("div",{staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconproject"}),t._v(" "+t._s(t.$t("views.vulnDetail.projectName"))+": ")]),t._v(" "+t._s(t.vulnObj.vul.project_name)+" ")]),a("div",{staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconzhongjianjian"}),t._v(" "+t._s(t.$t("views.vulnDetail.middleware"))+": ")]),a("span",{staticStyle:{width:"140px",overflow:"hidden"}},[t._v(" "+t._s(t.vulnObj.server.container)+" ")])]),a("div",{staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconshijian-3"}),t._v(" "+t._s(t.$t("views.vulnDetail.first_time"))+": ")]),t._v(" "+t._s(t.vulnObj.vul.first_time)+" ")])]),a("div",{staticClass:"infoLine flex-row-space-between"},[a("div",{staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconIp"}),t._v(" "+t._s(t.$t("views.vulnDetail.clientIp"))+": ")]),t._v(" "+t._s(t.vulnObj.vul.client_ip)+" ")]),a("div",{staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconyuyan-2"}),t._v(" "+t._s(t.$t("views.vulnDetail.language"))+": ")]),t._v(" "+t._s(t.vulnObj.vul.language)+" ")]),a("div",{staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconweixian-2"}),t._v(" "+t._s(t.$t("views.vulnDetail.level"))+": ")]),t._v(" "+t._s(t.vulnObj.vul.level)+" ")]),a("div",{staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconcishu-2"}),t._v(" "+t._s(t.$t("views.vulnDetail.counts"))+": ")]),t._v(" "+t._s(t.vulnObj.vul.counts)+" ")])])]),a("div",{staticClass:"module-title"},[t._v(" "+t._s(t.$t("views.vulnDetail.vulnDesc"))+" ")]),a("div",{staticClass:"vulnDesc"},[t._v(" "+t._s(t.vulnObj.strategy.desc)+" ")]),a("div",{staticClass:"module-title"},[t._v(" "+t._s(t.$t("views.vulnDetail.httpRequest"))+" ")]),a("div",{staticClass:"markdownContent httpRequest"},[a("MyMarkdownIt",{staticStyle:{color:"#747c8c"},attrs:{content:t.vulnObj.vul.req_header}})],1),t.vulnObj.vul.graphy&&t.vulnObj.vul.graphy.length>0?a("div",{staticClass:"module-title"},[t._v(" "+t._s(t.$t("views.vulnDetail.graphy"))+" ")]):t._e(),t.vulnObj.vul.graphy&&t.vulnObj.vul.graphy.length>0?a("div",{staticClass:"graphyModule flex-row-space-between"},[a("div",{staticClass:"left-warp"},[t._m(0),t._l(t.vulnObj.vul.graphy,(function(e,s){return a("div",{key:s,staticClass:"nodeLine flex-row-space-between"},[a("div",{staticClass:"flex-column-center",staticStyle:{padding:"0 5px"}},[a("i",{staticClass:"iconfont iconyuandianzhong",staticStyle:{"font-size":"12px",color:"#ec984f"},style:0===s?{color:"#5491ef"}:s===t.vulnObj.vul.graphy.length-1?{color:"#ec984f"}:{}})]),a("div",{staticClass:"node"},[t._v(" "+t._s(e.node)+" ")]),s<t.vulnObj.vul.graphy.length-1?a("i",{staticClass:"step el-icon-bottom"}):t._e()])}))],2),a("div",{staticClass:"right-warp"},[a("el-table",{staticClass:"graphyTable",staticStyle:{background:"#f8f9fb"},attrs:{data:t.vulnObj.vul.graphy,"row-class-name":t.tableRowClassName}},[a("el-table-column",{attrs:{align:"left",label:t.$t("views.vulnDetail.type"),prop:"type"}}),a("el-table-column",{attrs:{align:"center",label:t.$t("views.vulnDetail.fileAndNum"),"min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[a("div",[t._v(t._s(s.file))]),s.line_number?a("div",[t._v(t._s(s.line_number))]):t._e()]}}],null,!1,2212299247)}),a("el-table-column",{attrs:{align:"right",label:t.$t("views.vulnDetail.wuDianZhi"),prop:"target"}})],1)],1)]):t._e(),t.vulnObj.strategy.repair_suggestion?a("div",{staticClass:"module-title"},[t._v(" "+t._s(t.$t("views.vulnDetail.suggest"))+" ")]):t._e(),t.vulnObj.strategy.repair_suggestion?a("div",{staticClass:"markdownContent"},[a("MyMarkdownIt",{attrs:{content:t.vulnObj.strategy.repair_suggestion}})],1):t._e(),t.vulnObj.server.runtime?a("div",{staticClass:"module-title"},[t._v(" "+t._s(t.$t("views.vulnDetail.devEnv"))+" ")]):t._e(),t.vulnObj.server.runtime?a("div",{staticClass:"baseInfo"},[a("div",{staticClass:"base-line",staticStyle:{padding:"10px 0px",height:"10px"}},[a("span",[t._v(t._s(t.vulnObj.server.runtime))])])]):t._e(),a("div",{staticClass:"module-title"},[t._v(" "+t._s(t.$t("views.vulnDetail.path"))+" ")]),a("div",{staticClass:"baseInfo"},[a("div",{staticClass:"base-line"},[a("span",{staticStyle:{color:"black","font-family":"PingFangSC-Medium, PingFang SC",display:"block"}},[t._v(" "+t._s(t.$t("views.vulnDetail.command"))+" ")]),a("span",{staticStyle:{display:"block","margin-top":"6px"}},[t._v(t._s(t.vulnObj.server.command))])]),t.vulnObj.server.environment?a("div",{staticClass:"base-line"},[a("span",{staticStyle:{color:"black","font-family":"PingFangSC-Medium, PingFang SC"}},[t._v(t._s(t.$t("views.vulnDetail.other")))])]):t._e(),t.vulnObj.server.environment?a("div",{staticClass:"base-line",staticStyle:{"padding-top":"6px"}},[a("span",{staticStyle:{color:"#849ed8"}},[t._v(t._s(t.vulnObj.server.environment)+" ")])]):t._e()])]):t._e(),a("el-dialog",{attrs:{visible:t.deleteDialogOpen,title:"删除漏洞",width:"25%"},on:{"update:visible":function(e){t.deleteDialogOpen=e}}},[a("div",{staticStyle:{"text-align":"center"}},[a("p",{staticStyle:{color:"#959fb4"}},[t._v("漏洞删除后，将不可恢复")]),a("p",{staticStyle:{color:"#959fb4","margin-top":"14px"}},[t._v("请确认是否删除？")])]),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"confirmDel",attrs:{type:"text"},on:{click:t.vulnDelete}},[t._v(" 确认删除 ")]),a("el-button",{staticClass:"cancelDel",attrs:{type:"text"},on:{click:function(e){t.deleteDialogOpen=!1}}},[t._v(" 取消 ")])],1)])],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex-row-space-between"},[a("div",{staticClass:"tip"},[a("i",{staticClass:"iconfont iconyuandianzhong",staticStyle:{"font-size":"12px",color:"#5491ef"}}),t._v(" 污点来源 ")]),a("div",{staticClass:"tip"},[a("i",{staticClass:"iconfont iconyuandianzhong",staticStyle:{"font-size":"12px",color:"#f3bc3f"}}),t._v(" 传播方法 ")]),a("div",{staticClass:"tip"},[a("i",{staticClass:"iconfont iconyuandianzhong",staticStyle:{"font-size":"12px",color:"#ec984f"}}),t._v(" 危险方法 ")])])}],n=(a("99af"),a("13d5"),a("d3b7"),a("ac1f"),a("3ca3"),a("5319"),a("ddb0"),a("2b3d"),a("5530")),l=(a("96cf"),a("1da1")),r=a("d4ec"),c=a("bee2"),o=a("262e"),u=a("2caf"),v=a("9ab4"),p=a("60a3"),d=a("73ec"),b=a("8c73"),f=a("b32d"),h=function(t){Object(o["a"])(a,t);var e=Object(u["a"])(a);function a(){var t;return Object(r["a"])(this,a),t=e.apply(this,arguments),t.sliderWarpContract=!1,t.deleteDialogOpen=!1,t.vulnObj={vul:{url:"",uri:"",http_method:"",type:"",taint_position:"",first_time:0,latest_time:0,project_name:"",language:"",level:"",counts:0,req_header:"",graphy:[],context_path:""},server:{name:"",hostname:"",ip:"",port:0,container:"",container_path:"",runtime:"",environment:"",command:""},strategy:{desc:"",sample_code:"",repair_suggestion:""}},t.tableData=[],t.page=1,t.selectedId=0,t.total=0,t.cardIndex=0,t.searchObj={language:"",level:"",type:"",project_name:"",url:"",order:""},t.orderOptions=[{label:t.$t("views.vulnList.orderOptions.type"),value:"type"},{label:t.$t("views.vulnList.orderOptions.level"),value:"level"},{label:t.$t("views.vulnList.orderOptions.url"),value:"url"},{label:t.$t("views.vulnList.orderOptions.latest_time"),value:"latest_time"},{label:t.$t("views.vulnList.orderOptions.first_time"),value:"first_time"}],t}return Object(c["a"])(a,[{key:"created",value:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.page=parseInt(this.$route.params.page),this.selectedId=parseInt(this.$route.params.id),this.cardIndex=0,t.next=5,this.getVulnDetail();case 5:return t.next=7,this.getTableData();case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"newSelectData",value:function(){this.page=1,this.getTableData()}},{key:"currentChange",value:function(t){this.page=t,this.getTableData()}},{key:"getTableData",value:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i,l,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={page:this.page,pageSize:10,language:this.searchObj.language,level:this.searchObj.level,type:this.searchObj.type,project_name:this.searchObj.project_name,url:this.searchObj.url,order:this.searchObj.order},this.loadingStart(),t.next=4,this.services.vuln.vulnList(e);case 4:if(a=t.sent,s=a.status,i=a.data,l=a.page,r=a.msg,this.loadingDone(),201===s){t.next=13;break}return this.$message.error(r),t.abrupt("return");case 13:this.tableData=i.reduce((function(t,e){return t.push(Object(n["a"])(Object(n["a"])({},e),{},{latest_time:Object(d["c"])(e.latest_time)})),t}),[]),this.total=l.alltotal;case 15:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"idChange",value:function(t){this.selectedId=t,this.getVulnDetail()}},{key:"getVulnDetail",value:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i,l=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loadingStart(),t.next=3,this.services.vuln.getVulnDetail(this.selectedId);case 3:if(e=t.sent,a=e.data,s=e.status,i=e.msg,this.loadingDone(),201===s){t.next=11;break}return this.$message.error(i),t.abrupt("return");case 11:this.$nextTick((function(){l.vulnObj={vul:Object(n["a"])(Object(n["a"])({},a.vul),{},{req_header:a.vul.req_header.replace(/\n/g,"<br/>"),first_time:Object(d["b"])(a.vul.first_time),latest_time:Object(d["b"])(a.vul.latest_time),graphy:a.vul.graphy}),server:Object(n["a"])({},a.server),strategy:Object(n["a"])({},a.strategy)}}));case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"vulnDelete",value:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loadingStart(),t.next=3,this.services.vuln.vulnDelete(this.selectedId);case 3:e=t.sent,a=e.status,s=e.msg,this.loadingDone(),201!==a&&this.$message.error(s),this.$message.success(s),this.$router.push("/vuln/vulnList");case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"tableRowClassName",value:function(){return"diy-row"}},{key:"cardRowClassName",value:function(t,e){var a="";return t?a="selected":e%2===0&&(a="card-gap"),a}},{key:"exportVul",value:function(){var t=this,e=this.vulnObj.vul.project_name;f["a"].get("project/export?pname=".concat(e,"&vid=").concat(this.selectedId),{responseType:"blob"}).then((function(a){if(a.hasOwnProperty("response"))t.$message.error({message:"报告导出失败",showClose:!0});else{var s=new Blob([a],{type:"application/octet-stream"}),i=document.createElement("a");i.href=window.URL.createObjectURL(s),i.download=e+".doc",i.click(),t.$message.success({message:"报告导出成功",showClose:!0})}})).catch((function(e){t.$message.error({message:"报告导出失败",showClose:!0})}))}}]),a}(b["a"]);h=Object(v["b"])([Object(p["a"])({name:"VulnDetail"})],h);var g=h,_=g,m=(a("a426"),a("27fe"),a("2877")),y=Object(m["a"])(_,s,i,!1,null,"0df60120",null);e["default"]=y.exports},"3cde":function(t,e,a){},5530:function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));a("a4d3"),a("4de4"),a("4160"),a("e439"),a("dbb4"),a("b64b"),a("159b");function s(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function i(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function n(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?i(Object(a),!0).forEach((function(e){s(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}},a426:function(t,e,a){"use strict";a("3cde")},b24e:function(t,e,a){},b64b:function(t,e,a){var s=a("23e7"),i=a("7b0b"),n=a("df75"),l=a("d039"),r=l((function(){n(1)}));s({target:"Object",stat:!0,forced:r},{keys:function(t){return n(i(t))}})},d58f:function(t,e,a){var s=a("1c0b"),i=a("7b0b"),n=a("44ad"),l=a("50c4"),r=function(t){return function(e,a,r,c){s(a);var o=i(e),u=n(o),v=l(o.length),p=t?v-1:0,d=t?-1:1;if(r<2)while(1){if(p in u){c=u[p],p+=d;break}if(p+=d,t?p<0:v<=p)throw TypeError("Reduce of empty array with no initial value")}for(;t?p>=0:v>p;p+=d)p in u&&(c=a(c,u[p],p,o));return c}};t.exports={left:r(!1),right:r(!0)}},dbb4:function(t,e,a){var s=a("23e7"),i=a("83ab"),n=a("56ef"),l=a("fc6a"),r=a("06cf"),c=a("8418");s({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(t){var e,a,s=l(t),i=r.f,o=n(s),u={},v=0;while(o.length>v)a=i(s,e=o[v++]),void 0!==a&&c(u,e,a);return u}})},e439:function(t,e,a){var s=a("23e7"),i=a("d039"),n=a("fc6a"),l=a("06cf").f,r=a("83ab"),c=i((function(){l(1)})),o=!r||c;s({target:"Object",stat:!0,forced:o,sham:!r},{getOwnPropertyDescriptor:function(t,e){return l(n(t),e)}})}}]);
//# sourceMappingURL=chunk-71c944cd.5022d44b.js.map